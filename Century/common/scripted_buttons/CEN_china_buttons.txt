REPLACE:CHI_deport_missionaries_button = {
	name = "CHI_deport_missionaries_button"
	desc = "CHI_deport_missionaries_button_desc"

	visible = { always = yes }

	possible = {
		NOT = {
			any_neighbouring_state = {
				is_treaty_port = yes
				owner = {
					religion = {
						has_discrimination_trait = heritage_christian
					}
				}
			}
		}
		authority >= 200
		is_diplomatic_play_committed_participant = no
		custom_tooltip = {
			text = missionary_ban_2_tt
			NOT = { has_variable = CHI_deported_missionaries }
		}
	}

	selected = {
		has_variable = CHI_deported_missionaries
	}

	effect = {
		add_modifier = {
			name = modifier_chi_deporting_missionaries
			days = normal_modifier_time
		}
		every_country = {
			limit = {
				has_diplomatic_relevance = root
				religion = {
					has_discrimination_trait = heritage_christian
				}
				OR = {
					has_law_or_variant = law_type:law_state_religion
					has_law_or_variant = law_type:law_freedom_of_conscience
				}
			}
			change_relations = {
				country = root
				value = -25
			}
		}
		set_variable = CHI_deported_missionaries
	}
}

REPLACE:ban_opium_button = {
	name = "ban_opium"
	desc = "ban_opium_desc"

	visible = { 
		has_journal_entry = je_opium_obsession
		exists = market
		market.owner = root
		NOT = { is_banning_goods = g:opium }
	}

	possible = {
		has_journal_entry = je_opium_obsession
		NOT = { has_law_or_variant = law_type:law_free_trade }
		custom_tooltip = {
			text = not_lost_opium_wars_tt
			NOT = { has_global_variable = lost_opium_wars }
		}
		exists = market	
	}

	effect = {
		add_banned_goods = g:opium
		add_modifier = {
			name = opium_ban_authority
		}
		c:GBR = {
			change_relations = {
				country = root
				value = -30
			}
			create_diplomatic_catalyst = {
				type = catalyst_event_negative
				target = root
			}
		}
		remove_modifier = modifier_failure_to_ban
		
	}

	ai_chance = {
        base = 100
    }
}


REPLACE:unban_opium_button = {
	name = "remove_opium_ban"
	desc = "remove_opium_ban_desc"

	visible = { 
		has_journal_entry = je_opium_obsession
		is_banning_goods = g:opium
		exists = market
		market.owner = root
	}

	possible = {
		always = yes
	}

	effect = {
		remove_banned_goods = g:opium
		remove_modifier = opium_ban_authority
		add_modifier = {
			name = modifier_failure_to_ban
		}
	}

	ai_chance = {
		base = 0 
	}
}