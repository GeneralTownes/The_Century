# Root = Country
on_monthly_pulse_country = {
	on_actions = {
		CEN_coastal_capital
		CEN_colonial_institution_fix
		CEN_China
	}

	events = {
		communism.8 # Red Army
		peoples_springtime.1
		opium_wars.1
		native_resettlement.1
		meiji.13
		bic_breakup.1
		dreyfus.1
		dei_breakup.1
		alk_breakup.1
		poland_events.3 # Polish Unification
		colonial_administration_events.2 # African Colony Radicals
		caudillo.1
		sa_migration.5
		amazonas.1 # Taming Amazonia
		paraguay.11 # Paraguay War
		acw_events.9 # CSA victory event
		persia_events.5 # Persian slave liberation event
		treaty_of_london_events.1 # Treaty of London initiation event

		# Exile Agitators Events
		yeet_agitator_events.1
		yeet_agitator_events.2
		yeet_agitator_events.3

		# Comte
		positivism.1

		# Milyutin
		caucasuswar.5

		# Phool Walon Ki Sair
		india_events.8
		
		# Princely State Creation
		princely_state_creation.1
		princely_state_creation.2
		princely_state_creation.3
		princely_state_creation.4
		princely_state_creation.5

		# Set Hierarchy Events
		set_hierarchy_event.1 # Sets British Indian Caste System
		set_hierarchy_event.2 # Replaces British Indian Caste System with Default
	}

	effect = {
		trigger_event = { id = unable_to_enact.1 }
		
		if = {
			limit = {
				c:GBR ?= this
				game_date >= 1841.11.09
				ruler ?= {
					has_template = gbr_queen_victoria_template
				}
				OR = {
					NOT = {
						exists = heir
					}
					heir = { # PRCAL-33820 victoria is ruler and heir, therefore this check is here
						has_template = gbr_queen_victoria_template
					}
				}
				NOT = {
					has_variable = edward_vii_heir_var
				}
			}
			create_character = {
				template = gbr_albert_edward_template
				heir = yes
			}
			set_variable = edward_vii_heir_var
		}

		# Sweden Monarchy event
		if = {
			limit = {
				c:SWE ?= this
				game_date >= 1859.6.29
				ruler ?= {
					has_template = swe_oscar_bernadotte_template
				}
				heir = {
					has_template = swe_charles_bernadotte_template
				}
			}
			trigger_event = { id = sweden_monarchy.2 popup = yes }
		}
		if = {
			limit = {
				c:SWE ?= this
				game_date >= 1859.6.29
				NOT = {
					ruler ?= {
						has_template = swe_oscar_bernadotte_template
					}
					has_variable = charles_xv_ruler_var
				}
			}
			set_variable = charles_xv_ruler_var
			create_character = {
				template = swe_oscar_ii_bernadotte_template
				heir = yes
				is_admiral = yes
			}
			if = {
				limit = {
					any_scope_character = {
						has_template = swe_charles_bernadotte_template
					}
				}
				random_scope_character = {
					limit = {
						has_template = swe_charles_bernadotte_template
					}
					add_trait = cancer
				}
			}
		}

      if = {
      	limit = {
	         c:SWE ?= this
	         game_date >= 1872.9.29
	         any_scope_character = {
	         	is_ruler = yes
	         	has_template = swe_charles_bernadotte_template
	         }
	         any_scope_character = {
	         	is_heir = yes
	         	has_template = swe_oscar_ii_bernadotte_template
	         }
	      }
         trigger_event = { id = sweden_monarchy.3 popup = yes }
      }

      if = {
      	limit = {
	         c:SWE ?= this
	         game_date >= 1872.9.29
	         any_scope_character = {
	         	is_ruler = yes
	         	has_template = swe_oscar_ii_bernadotte_template

	         }
	         NOT = {
	         	has_variable = oscar_ii_ruler_var
	         }
	      }
			create_character = {
				template = swe_gustaf_v_bernadotte_template
				heir = yes
			}
			set_variable = oscar_ii_ruler_var
      }

		### This is how we give objectives to AI countries
		if = {
			limit = {
				has_journal_entry = je_great_game_control
				has_dlc_feature = ep1_content
				is_player = no
			}
			if = {
				limit = {
					c:RUS ?= this
				}
				### Generic Objectives
				if = {
					limit = {
						NOT = {
							has_variable = je_tibet_expedition_ai_var
						}
						has_variable = tibet_has_started
						NOT = { has_global_variable = tibet_expedition_completed }
						has_interest_marker_in_region = region_himalayas
					}
					set_variable = je_tibet_expedition_ai_var
					add_journal_entry = {
						type = je_tibet_expedition
					}
				}
				if = {
					limit = {
						NOT = {
							has_variable = je_consolidate_afghanistan_objective_ai_var
						}
						has_interest_marker_in_region = region_persia
						exists = c:AFG
					}
					set_variable = je_consolidate_afghanistan_objective_ai_var
					add_journal_entry = {
						type = je_consolidate_afghanistan_objective
					}
				}
				if = {
					limit = {
						NOT = {
							has_variable = je_maintain_afghan_protectorate_ai_var
						}
						NOT = {
							has_global_variable = gg_afghanistan_protectorate_done
						}
						has_interest_marker_in_region = region_persia
					}
					set_variable = je_maintain_afghan_protectorate_ai_var
					add_journal_entry = {
						type = je_maintain_afghan_protectorate
					}
				}
				if = {
					limit = {
						NOT = {
							has_variable = je_secure_influence_over_persia_ai_var
						}
						has_interest_marker_in_region = region_persia
					}
					set_variable = je_secure_influence_over_persia_ai_var
					add_journal_entry = {
						type = je_secure_influence_over_persia
					}
				}

				### Specific Objectives
				if = {
					limit = {
						NOT = {
							has_variable = je_secure_persian_border_ai_var
						}
						exists = c:CIR
					}
					set_variable = je_secure_persian_border_ai_var
					add_journal_entry = {
						type = je_secure_persian_border
					}
				}
				if = {
					limit = {
						NOT = {
							has_variable = je_pacify_kazakh_steppes_ai_var
						}
						has_journal_entry = je_pacify_the_steppes
					}
					set_variable = je_pacify_kazakh_steppes_ai_var
					add_journal_entry = {
						type = je_pacify_kazakh_steppes
					}
				}
				if = {
					limit = {
						NOT = {
							has_variable = je_codify_chinese_border_ai_var
						}
						has_technology_researched = nationalism
					}
					set_variable = je_codify_chinese_border_ai_var
					add_journal_entry = {
						type = je_codify_chinese_border
					}
				}
				if = {
					limit = {
						NOT = {
							has_variable = je_consolidate_central_asia_ai_var
						}
						has_technology_researched = nationalism
					}
					set_variable = je_consolidate_central_asia_ai_var
					add_journal_entry = {
						type = je_consolidate_central_asia
					}
				}
				if = {
					limit = {
						NOT = {
							has_variable = je_chinese_concessions_ai_var
						}
						has_technology_researched = railways
						any_scope_state = {
							OR = {
								state_region = s:STATE_OUTER_MANCHURIA
								state_region = s:STATE_AMUR
							}
							is_incorporated = yes
						}
					}
					set_variable = je_chinese_concessions_ai_var
					add_journal_entry = {
						type = je_chinese_concessions
					}
				}
				if = {
					limit = {
						NOT = {
							has_variable = je_acquire_korean_protectorate_ai_var
						}
						any_neighbouring_state = {
							owner = c:KOR
							is_incorporated = yes
						}
						c:KOR ?= {
							is_country_type = unrecognized
						}
					}
					set_variable = je_acquire_korean_protectorate_ai_var
					add_journal_entry = {
						type = je_acquire_korean_protectorate
					}
				}
			}
			
			if = {
				limit = {
					c:GBR ?= this
					has_journal_entry = je_great_game_control
				}
				### Generic Objectives
				if = {
					limit = {
						NOT = {
							has_variable = je_tibet_expedition_ai_var
						}
						has_variable = tibet_has_started
						NOT = { has_global_variable = tibet_expedition_completed }
						has_interest_marker_in_region = region_himalayas
					}
					set_variable = je_tibet_expedition_ai_var
					add_journal_entry = {
						type = je_tibet_expedition
					}
				}
				if = {
					limit = {
						NOT = {
							has_variable = je_consolidate_afghanistan_objective_ai_var
						}
						has_interest_marker_in_region = region_persia
						exists = c:AFG
					}
					set_variable = je_consolidate_afghanistan_objective_ai_var
					add_journal_entry = {
						type = je_consolidate_afghanistan_objective
					}
				}
				if = {
					limit = {
						NOT = {
							has_variable = je_maintain_afghan_protectorate_ai_var
						}
						NOT = {
							has_global_variable = gg_afghanistan_protectorate_done
						}
						has_interest_marker_in_region = region_persia
					}
					set_variable = je_maintain_afghan_protectorate_ai_var
					add_journal_entry = {
						type = je_maintain_afghan_protectorate
					}
				}
				if = {
					limit = {
						NOT = {
							has_variable = je_secure_influence_over_persia_ai_var
						}
						has_interest_marker_in_region = region_persia
					}
					set_variable = je_secure_influence_over_persia_ai_var
					add_journal_entry = {
						type = je_secure_influence_over_persia
					}
				}
				### Specific Objectives
				if = {
					limit = {
						NOT = {
							has_variable = je_disrupt_russian_caucasus_ai_var
						}
						exists = c:CIR
					}
					set_variable = je_disrupt_russian_caucasus_ai_var
					add_journal_entry = {
						type = je_disrupt_russian_caucasus
					}
				}
				if = {
					limit = {
						NOT = {
							has_variable = je_counter_russian_pacific_influence_ai_var
						}
						c:RUS ?= {
							any_scope_state = {
								region = sr:region_manchuria
								OR = {
									any_scope_building = {
										is_building_type = building_port
										level >= 5
									}
									any_scope_building = {
										is_building_type = building_naval_base
										level >= 15
									}
								}
							}
						}
					}
					set_variable = je_counter_russian_pacific_influence_ai_var
					add_journal_entry = {
						type = je_counter_russian_pacific_influence
					}
				}
				if = {
					limit = {
						NOT = {
							has_variable = je_consolidate_british_india_ai_var
						}
						c:BIC ?= {
							is_subject_of = c:GBR
						}
					}
					set_variable = je_consolidate_british_india_ai_var
					add_journal_entry = {
						type = je_consolidate_british_india
					}
				}
				if = {
					limit = {
						NOT = {
							has_variable = je_pamir_expedition_objective_ai_var
						}
						c:RUS ?= {
							OR = {
								any_scope_state = {
									state_region = s:STATE_TAJIKISTAN
								}
								any_subject_or_below = {
									any_scope_state = {
										state_region = s:STATE_TAJIKISTAN
									}
								}
							}
						}
						NOT = {
							has_variable = dismissed_pamir_expedition
						}
					}
					set_variable = je_pamir_expedition_objective_ai_var
					add_journal_entry = {
						type = je_pamir_expedition_objective
					}
				}
			}
			
			if = {
				limit = {
					is_afghan_nation = yes
					has_journal_entry = je_great_game_control
				}
				### Generic Objectives
				if = {
					limit = {
						NOT = {
							has_variable = je_achieve_sovereignty_ai_var
						}
						is_country_type = unrecognized
					}
					set_variable = je_achieve_sovereignty_ai_var
					add_journal_entry = {
						type = je_achieve_sovereignty
					}
				}
				### Specific Objectives
				if = {
					limit = {
						NOT = {
							has_variable = je_unify_afghanistan_objective_ai_var
						}
					}
					set_variable = je_unify_afghanistan_objective_ai_var
					add_journal_entry = {
						type = je_unify_afghanistan_objective
					}
				}
			}
			
			if = {
				limit = {
					c:PER ?= this
					has_journal_entry = je_great_game_control
				}
				### Generic Objectives
				if = {
					limit = {
						NOT = {
							has_variable = je_achieve_sovereignty_ai_var
						}
						is_country_type = unrecognized
					}
					set_variable = je_achieve_sovereignty_ai_var
					add_journal_entry = {
						type = je_achieve_sovereignty
					}
				}
				### Specific Objectives
				if = {
					limit = {
						NOT = {
							has_variable = je_consolidate_persia_ai_var
						}
					}
					set_variable = je_consolidate_persia_ai_var
					add_journal_entry = {
						type = je_consolidate_persia
					}
				}
			}
		}
		
		# TODO: Move these to tag-specific pulses
		if = {
			limit = {
				c:FRA ?= this
				c:FRA ?= {
					OR = {
						has_modifier = modifier_haitian_independence_payments_1
						has_modifier = modifier_haitian_independence_payments_2
						has_modifier = modifier_haitian_independence_payments_3
						has_modifier = modifier_haitian_independence_payments_4
					}
				}
				NOT = { exists = c:HAI }
			}
			c:FRA = {
				if = {
					limit = {
						has_modifier = modifier_haitian_independence_payments_1
					}
					remove_modifier = modifier_haitian_independence_payments_1
				}
				if = {
					limit = {
						has_modifier = modifier_haitian_independence_payments_2
					}
					remove_modifier = modifier_haitian_independence_payments_2 
				}
				if = {
					limit = {
						has_modifier = modifier_haitian_independence_payments_3
					}
					remove_modifier = modifier_haitian_independence_payments_3
				}
				if = {
					limit = {
						has_modifier = modifier_haitian_independence_payments_4
					}
					remove_modifier = modifier_haitian_independence_payments_4
				}
			}
		}
		if = { # Removes the Berar lease modifier if no longer relevant
			limit = {
				c:BIC ?= this
				c:BIC ?= {
					has_modifier = lease_of_berar_costs
				}
				OR = {
					NOT = { exists = c:HYD }
					c:BIC ?= {
						has_war_with = c:HYD
					}
					c:BIC = {
						NOT = {
							any_scope_state = {
								state_region = s:STATE_CENTRAL_PROVINCES
							}
						}
					}
				}
			}
			c:BIC ?= {
				remove_modifier = lease_of_berar_costs
			}
			c:HYD ?= {
				remove_modifier = lease_of_berar_income
			}
		}
		if = { #Exists to make sure independent Perus get this ASAP.
			limit = {
				OR = {
					c:NPU ?= this
					c:SPU ?= this
				}
				is_subject = no
				NOT = {
					has_variable = peru_has_claims
				}
				OR = {
					AND = { #SPU is either dead or a puppet, will not fire if it is independent.
						c:NPU ?= this
						OR = {
							NOT = {
								exists = c:SPU
							}
							c:SPU ?= { is_subject = yes }
						}
					}
					AND = {
						c:SPU ?= this
						OR = {
							NOT = {
								exists = c:SPU
							}
							c:NPU ?= { is_subject = yes }
						}
					}
				}
			}
			trigger_event = { id = peru_bolivia_events.8 days = 0 popup = yes }
		}

		
		if = {
			limit = {
				NOT = {
					has_variable = cant_touch_this_achievement_possible
				}
				any_country = {
					NOT = {
					   THIS = ROOT
					}
					ROOT = {
						"gdp_ownership_ratio(prev)" > 0.10
					}	
			    }
			}
			set_variable = cant_touch_this_achievement_possible
		}

		if = {
			limit = {
				is_country_type = colonial # The colonial country type, for now, is only used for colonies whilst they are subjects of another power
				is_subject = no
			}
			set_country_type = recognized
		}
		
		if = { # Creates Petrograd
			limit = {
				country_has_primary_culture = cu:russian
				has_technology_researched = nationalism
				NOT = { has_law = law_type:law_council_republic }

				OR = {
					any_rival_country = {
						any_primary_culture = {
							has_discrimination_trait = german_speaking
						}
					}
					any_rivaling_country = {
						any_primary_culture = {
							has_discrimination_trait = german_speaking
						}					
					}
				}
				any_scope_state = {
					state_region = s:STATE_INGRIA
				}
				NOT = {
					has_variable = petrograd_var
				}
			}
			set_variable = petrograd_var
			random_scope_state = {
				limit = {
					state_region = s:STATE_INGRIA
				}
				STATE_INGRIA_state_name_assign = yes
			}
		}
	}
	on_actions = { # delay ensures events won't fire simultaneously
		coup_monthly_events
		delay = { days = 4 }
		garibaldi_monthly_events
		delay = { days = 7 }
		fund_lobbies_monthly_events
		spooky_halloween_events
	}
}

# Root = State
on_monthly_pulse_state = {
	random_events = {
		10 = goldrush.5
	}
	on_actions = {
		CEN_uni_removal
	}
}

# Vanilla + China Fracture
on_revolution_start = {
	effect = {
		scope:target ?= {
			enact_preferred_governance_principle = yes
			if = {
				limit = {
					has_law = law_type:law_single_party_state
				}
				handle_revolutionary_sps = yes
			}
		}
		if = {
			limit = {
				has_law = law_type:law_monarchy
				scope:target ?= {
					NOT = {
						has_law = law_type:law_monarchy
					}
				}
			}
			set_variable = anti_monarchist_revolution
		}
		if = {
			limit = {
				has_journal_entry = je_warlord_china
				NOT = { has_global_variable = china_warlord_explosion_revolution }
			}
			chi_add_1_fracture = yes
			set_global_variable = china_warlord_explosion_revolution
		}
		if = {
			limit = {
				OR = {
					has_journal_entry = je_meiji_restoration
					has_inactive_journal_entry = je_meiji_restoration
				}
				scope:target ?= {
					ig:ig_landowners = {
						is_in_government = yes
					}
				}
			}
			set_variable = anti_shogunate_civil_war
		}
		if = {
			limit = {
				has_journal_entry = je_the_paris_commune_france
			}
			c:FRA = {
				trigger_event = { id = paris_commune.4 popup = yes }
			}
			random_scope_state = {
				limit = {
					state_region = s:STATE_ILE_DE_FRANCE
				}
				set_state_owner = c:PRC
			}
			c:PRC = {
				annex = scope:target
				create_diplomatic_play = {
					type = dp_revolution
					target_state = c:FRA.capital
					annex_as_civil_war = yes
				}
			}
		}
		if = {
			limit = {
				has_dlc_feature = voice_of_the_people_content
				c:KRA ?= root
				c:AUS ?= {
					any_subject_or_below = {
						c:KRA ?= this
					}
				}
			}
			c:AUS = {
				trigger_event = { id = krakow.1 days = 3 popup = yes }
			}
		}
		if = {
			limit = {
				has_dlc_feature = voice_of_the_people_content
				c:FRA ?= ROOT
			}
			if = {
				limit = {
					scope:target ?= {
						is_secessionist = no
						has_law = law_type:law_monarchy
						any_interest_group = {
							is_in_government = yes
							is_strongest_ig_in_government = yes
							leader = {
								has_ideology = ideology:ideology_orleanist
							}
						}
					}
				}
				scope:target ?= {
					if = {
						limit = {
							has_variable = bonapartist_restoration_var
						}
						remove_variable = bonapartist_restoration_var
					}
					if = {
						limit = {
							has_variable = legitimist_restoration_var
						}
						remove_variable = legitimist_restoration_var
					}
					set_variable = { name = orleanist_restoration_var }
					if = {
						limit = {
							ROOT.ruler = {
								has_ideology = ideology:ideology_orleanist
							}
						}
						create_character = {
							template = dynamic_orleanist_ruler_template
						}
					}
					else = {
						generate_french_monarch = yes
					}
				}
			}
			else_if = {
				limit = {
					scope:target ?= {
						is_secessionist = no
						has_law = law_type:law_monarchy
						any_interest_group = {
							is_in_government = yes
							is_strongest_ig_in_government = yes
							leader = {
								has_ideology = ideology:ideology_legitimist
							}
						}
					}
				}
				scope:target ?= {
					if = {
						limit = {
							has_variable = bonapartist_restoration_var
						}
						remove_variable = bonapartist_restoration_var
					}
					if = {
						limit = {
							has_variable = orleanist_restoration_var
						}
						remove_variable = orleanist_restoration_var
					}
					set_variable = { name = legitimist_restoration_var }
					if = {
						limit = {
							ROOT.ruler = {
								has_ideology = ideology:ideology_legitimist
							}
						}
						create_character = {
							template = dynamic_legitimist_ruler_template
						}
					}
					else = {
						generate_french_monarch = yes
					}
				}
			}
			else_if = {
				limit = {
					scope:target ?= {
						is_secessionist = no
						has_law = law_type:law_monarchy
						any_interest_group = {
							is_in_government = yes
							is_strongest_ig_in_government = yes
							leader = {
								has_ideology = ideology:ideology_bonapartist
							}
						}
					}
				}
				scope:target ?= {
					if = {
						limit = {
							has_variable = orleanist_restoration_var
						}
						remove_variable = orleanist_restoration_var
					}
					if = {
						limit = {
							has_variable = legitimist_restoration_var
						}
						remove_variable = legitimist_restoration_var
					}
					set_variable = { name = bonapartist_restoration_var }
					if = {
						limit = {
							ROOT.ruler = {
								has_ideology = ideology:ideology_bonapartist
							}
						}
						create_character = {
							template = dynamic_bonapartist_ruler_template
						}
					}
					else = {
						generate_french_monarch = yes
					}
				}
			}
		}
		if = {
			limit = {
				has_dlc_feature = ep1_content
				c:KOR ?= ROOT
				c:JAP ?= {
					NOT = {
						has_law = law_type:law_isolationism
					}
					has_interest_marker_in_region = region_manchuria
					has_technology_researched = electric_telegraph
				}
				any_country = {
					OR = {
						country_has_primary_culture = cu:han
						country_has_primary_culture = cu:manchu
					}
					any_subject_or_below = {
						c:KOR = this
					}
					has_technology_researched = electric_telegraph
				}
			}
			c:JAP = {
				trigger_event = { id = gg_korea.7 popup = yes }
			}
			random_country = {
				limit = {
					OR = {
						country_has_primary_culture = cu:han
						country_has_primary_culture = cu:manchu
					}
					any_subject_or_below = {
						c:KOR = this
					}
				}
				trigger_event = { id = gg_korea.7 popup = yes }
			}
		}
		### Movement type variable setting
		ROOT = {
			random_civil_war = {
				limit = {
					is_civil_war_type = revolution
				}
				scope:target ?= {
					set_variable = { name = civil_war_type_var value = prev.political_movement.type }
				}
			}
		}
		if = { # Script hack for Indian revolutions
			limit = {
				c:BIC ?= ROOT
				ROOT = {
					any_civil_war = {
						is_civil_war_type = revolution
						political_movement ?= {
							NOR = {
								is_political_movement_type = movement_religious_majority
								is_political_movement_type = movement_cultural_majority
								is_political_movement_type = movement_utilitarian
								culture ?= {
									has_discrimination_trait = european_heritage
								}
							}
						}
					}
				}
			}
			scope:target ?= {
				change_tag = BHT
				remove_primary_culture = cu:british
				grant_indian_cultures = yes
				if = {
					limit = {
						NOT = {
							has_law = law_type:law_state_atheism
						}
					}
					if = {
						limit = {
							religion_percent_country = {  
								target = rel:hindu  
								value >= 0.5
							}
						}
						set_state_religion = rel:hindu
					}
					else_if = {
						limit = {
							religion_percent_country = {  
								target = rel:sunni
								value >= 0.5
							}
						}
						set_state_religion = rel:sunni
					}
					else = {
						set_state_religion = rel:hindu
					}
				}
				india_independence_ig_effects = yes
				if = {
					limit = {
						has_modifier = modifier_india_crown_rule
					}
					remove_modifier = modifier_india_crown_rule
				}
				if = {
					limit = {
						has_modifier = modifier_india_company_rule
					}
					remove_modifier = modifier_india_company_rule
				}
				recalculate_pop_ig_support = yes
				every_scope_character = {
					limit = {
						OR = {
							culture = cu:british
							culture = cu:scottish
							culture = cu:irish
						}
						is_immortal = no
					}
					kill_character = yes
				}
			}
		}
	}
}

# Vanilla + China Fracture
on_secession_start = {
	effect = {
		if = {
			limit = {
				has_journal_entry = je_warlord_china
				NOT = { has_global_variable = china_warlord_explosion_secession }
			}
			chi_add_1_fracture = yes
			set_global_variable = china_warlord_explosion_secession
		}
		if = {
			limit = {
				NOT = {
					exists = c:RSM
				}
				scope:target ?= {
					OR = {
						country_has_primary_culture = cu:north_italian
						country_has_primary_culture = cu:south_italian
					}
				}
				ROOT = {
					NOR = {
						country_has_primary_culture = cu:north_italian
						country_has_primary_culture = cu:south_italian
					}
				}
				any_country = {
					has_journal_entry = je_risorgimento
				}
			}
			root = {
				trigger_event = { id = italian_unification.7 days = 3 }
			}
		}
		if = {
			limit = {
				NOR = {
			        c:POL ?= this
			        c:KRA ?= this
			        AND = {
			            c:GAL ?= this
			            ruler = {
			                culture = cu:polish
			            }
			        }
				}
				scope:target ?= {
					OR = {
			            c:POL ?= this
			            c:KRA ?= this
			            AND = {
			                c:GAL ?= this
			                ruler = {
			                    culture = cu:polish
			                }
			            }
			        }
				}
				OR = {
					c:POL ?= {
						NOT = {
							this = scope:target
						}
					}
					c:KRA ?= {
						NOT = {
							this = scope:target
						}
					}
					c:GAL ?= {
						NOT = {
							this = scope:target
						}
					}
				}
			}
			scope:target ?= {
				set_variable = {
					name = polish_rebel_country_var
					months = short_modifier_time
				}
			}
			set_variable = {
				name = polish_rebel_country_enemy_var
				months = short_modifier_time
			}
			every_country = {
				limit = {
					OR = {
						c:POL ?= this
						c:KRA ?= this
			            AND = {
			                c:GAL ?= this
			                ruler = {
			                    culture = cu:polish
			                }
			            }
					}
					NOT = {
						this = scope:target
					}

				}
				trigger_event = { id = poland_events.5 days = 7 popup = yes }
			}
		}
		if = { # Script hack for Indian secessions
			limit = {
				c:BIC ?= ROOT
			}
			scope:target ?= {
				remove_primary_culture = cu:british
				grant_indian_regional_cultures = yes
				if = {
					limit = {
						NOT = {
							has_law = law_type:law_state_atheism
						}
					}
					if = {
						limit = {
							religion_percent_country = {  
								target = rel:hindu  
								value >= 0.5
							}
						}
						set_state_religion = rel:hindu
					}
					else_if = {
						limit = {
							religion_percent_country = {  
								target = rel:sunni
								value >= 0.5
							}
						}
						set_state_religion = rel:sunni
					}
					else = {
						set_state_religion = rel:hindu
					}
				}
				india_independence_ig_effects = yes
				if = {
					limit = {
						has_modifier = modifier_india_crown_rule
					}
					remove_modifier = modifier_india_crown_rule
				}
				if = {
					limit = {
						has_modifier = modifier_india_company_rule
					}
					remove_modifier = modifier_india_company_rule
				}
				recalculate_pop_ig_support = yes
				every_scope_character = {
					limit = {
						OR = {
							culture = cu:british
							culture = cu:scottish
							culture = cu:irish
						}
						is_immortal = no
					}
					kill_character = yes
				}
			}
		}
	}
}

# Punishing Qing releasing Chinese states
on_country_released_as_independent = {
	effect = {
		if = {
			limit = {
				c:NEN ?= scope:target
			}
			scope:target ?= {
				create_character = {
					ig_leader = yes
					interest_group = ig_rural_folk
					ideology = ideology_luddite
				}
			}
		}
		if = {
			limit = {
				scope:target ?= {
					country_has_primary_culture = cu:ashkenazi
				}
				NOT = {
					s:STATE_PALESTINE = {
						is_homeland = cu:ashkenazi
					}
				}
			}
			s:STATE_PALESTINE = {
				add_homeland = cu:sephardic
				add_homeland = cu:ashkenazi
			}
		}
		if = {
			limit = {
				scope:target ?= {
					OR = {
						country_has_primary_culture = cu:afro_caribbean
						country_has_primary_culture = cu:afro_antillean
						country_has_primary_culture = cu:afro_american
						country_has_primary_culture = cu:afro_caribeno
						country_has_primary_culture = cu:afro_brazilian
					}
					OR = {
						has_law = law_type:law_legacy_slavery
						has_law = law_type:law_slave_trade
					}
				}
			}
			scope:target ?= {
				trigger_event = { id = slave_revolt_events.1 days = 0 }
			}
		}
		
		### Penalising Fragile China releasing subjects
		if = {
			limit = {
				ROOT = { has_journal_entry = je_warlord_china }
				scope:target = {
					OR = {
						country_has_primary_culture = cu:han
						country_has_primary_culture = cu:manchu
						country_has_primary_culture = cu:hakka
						country_has_primary_culture = cu:min
						country_has_primary_culture = cu:yue
						country_has_primary_culture = cu:miao
						country_has_primary_culture = cu:zhuang
						country_has_primary_culture = cu:yi
					}
				}
			}
			chi_add_1_fracture = yes
		}
		
		### Releasing Warlords
		if = {
			limit = {
				has_modifier = early_warlords_collapse
				scope:target ?= {
					NOT = {
						has_modifier = early_warlords_collapse
					}
					OR = {
						country_has_primary_culture = cu:han
						country_has_primary_culture = cu:manchu
						country_has_primary_culture = cu:hakka
						country_has_primary_culture = cu:min
						country_has_primary_culture = cu:yue
						country_has_primary_culture = cu:miao
						country_has_primary_culture = cu:zhuang
						country_has_primary_culture = cu:yi
					}
				}
			}
			scope:target ?= {
				assign_early_warlords_penalty = yes
			}
		}
	}
}
# Root = Releasing Country
# scope:target = Released Country
on_country_released_as_own_subject = {
	effect = {
		if = {
			limit = {
				c:NEN ?= scope:target
			}
			scope:target ?= {
				create_character = {
					ig_leader = yes
					interest_group = ig_rural_folk
					ideology = ideology_luddite
				}
			}
		}
		if = {
			limit = {
				scope:target ?= {
					country_has_primary_culture = cu:ashkenazi
				}
				NOT = {
					s:STATE_PALESTINE = {
						is_homeland = cu:ashkenazi
					}
				}
			}
			s:STATE_PALESTINE = {
				add_homeland = cu:sephardic
				add_homeland = cu:ashkenazi
			}
		}
		scope:target ?= {
			if = {
				limit = {
					country_has_state_religion = rel:theravada
				}
				ig:ig_devout = {
					set_interest_group_name = ig_theravada_monks
					remove_ideology = ideology_moralist
					add_ideology = ideology_buddhist_moralist
				}
			}
			if = {
				limit = {
					exists = c:RUS
					c:RUS = scope:target
				}
				ig:ig_devout = {
					set_interest_group_name = ig_orthodox_church
					remove_ideology = ideology_patriarchal
					add_ideology = ideology_russian_patriarch
				}
			}
			if = {
				limit = {
					country_has_state_religion = rel:orthodox
					OR = {
						NOT = { exists = c:RUS }
						NOT = { c:RUS = scope:target }
					}
				}
				ig:ig_devout = {
					set_interest_group_name = ig_orthodox_church
					remove_ideology = ideology_patriarchal
					add_ideology = ideology_orthodox_patriarch
				}
			}
			if = {
				limit = {
					country_has_state_religion = rel:hindu
				}
				ig:ig_devout = {
					set_interest_group_name = ig_hindu_priesthood
					remove_ideology = ideology_moralist
					add_ideology = ideology_hindu_moralist
				}
			}
			if = {
				limit = {
					country_has_state_religion = rel:gelugpa
				}
				ig:ig_devout = {
					set_interest_group_name = ig_vajrayana_monks
					remove_ideology = ideology_moralist
					add_ideology = ideology_buddhist_moralist
				}
			}
			if = {
				limit = {
					country_has_state_religion = rel:mahayana
				}
				ig:ig_devout = {
					set_interest_group_name = ig_mahayana_monks
					remove_ideology = ideology_moralist
					add_ideology = ideology_buddhist_moralist
				}
			}
			if = {
				limit = {
					country_has_state_religion = rel:sikh
				}
				ig:ig_devout = {
					set_interest_group_name = ig_sikh_priesthood
					remove_ideology = ideology_moralist
					add_ideology = ideology_sikh_moralist
				}
			}
			if = {
				limit = {
					country_has_state_religion = rel:oriental_orthodox
				}
				ig:ig_devout = {
					set_interest_group_name = ig_oriental_orthodox_church
					remove_ideology = ideology_patriarchal
					add_ideology = ideology_oriental_orthodox_patriarch
				}
			}
		}
		
		### Penalising Fragile China releasing subjects
		if = {
			limit = {
				ROOT = { has_journal_entry = je_warlord_china }
				scope:target = {
					OR = {
						country_has_primary_culture = cu:han
						country_has_primary_culture = cu:manchu
						country_has_primary_culture = cu:hakka
						country_has_primary_culture = cu:min
						country_has_primary_culture = cu:yue
						country_has_primary_culture = cu:miao
						country_has_primary_culture = cu:zhuang
						country_has_primary_culture = cu:yi
					}
				}
			}
			chi_add_1_fracture = yes
			remove_diplomatic_pact = {
				country = scope:target 
				type = vassal
			}
		}
		
		### Releasing Warlords
		if = {
			limit = {
				has_modifier = early_warlords_collapse
				scope:target ?= {
					NOT = {
						has_modifier = early_warlords_collapse
					}
					OR = {
						country_has_primary_culture = cu:han
						country_has_primary_culture = cu:manchu
						country_has_primary_culture = cu:hakka
						country_has_primary_culture = cu:min
						country_has_primary_culture = cu:yue
						country_has_primary_culture = cu:miao
						country_has_primary_culture = cu:zhuang
						country_has_primary_culture = cu:yi
					}
				}
			}
			scope:target ?= {
				assign_early_warlords_penalty = yes
			}
		}
	}
}