CEN_uni_removal = {
	effect = {
		if = {
			limit = {
				is_incorporated = no
				has_building = building_university
			}
			remove_building = building_university
		}
	}
}

on_building_expanded = {
	effect = {
		# when a railroad finishes expanding, increase railroad variable
		if = {
			limit = {
				is_building_type = building_railway
			}
			this.owner = {
				if = {
					limit = {
						has_journal_entry = je_chinese_industry
					}
					change_global_variable = {
						name = chinese_rail_expansion
						add = 1
					}
				}
			}
		}
	}
}

CEN_coastal_capital = {
	effect = {
		if = {
			limit = {
				NOT = { has_modifier = coastal_capital }
				capital = { is_coastal = yes }
			}
			add_modifier = {
				name = coastal_capital
				months = -1
			}
		}
		if = {
			limit = {
				NOT = { has_modifier = near_coastal_capital }
				capital = {
					OR = {
						state_region = s:STATE_NANJING
						state_region = s:STATE_ILE_DE_FRANCE
						state_region = s:STATE_BRANDENBURG
						state_region = s:STATE_AUSTRIA
						state_region = s:STATE_TRANSDANUBIA
					}
				}
			}
			add_modifier = {
				name = near_coastal_capital
				months = -1
			}
		}
		if = {
			limit = {
				has_modifier = coastal_capital
				capital = {
					is_coastal = no
				}
			}
			remove_modifier = coastal_capital
		}
		if = {
			limit = {
				has_modifier = near_coastal_capital
				capital = {
					NOR = {
						state_region = s:STATE_NANJING
						state_region = s:STATE_ILE_DE_FRANCE
						state_region = s:STATE_BRANDENBURG
						state_region = s:STATE_AUSTRIA
						state_region = s:STATE_TRANSDANUBIA
					}
				}
			}
			remove_modifier = near_coastal_capital
		}
	}
}

CEN_colonial_institution_fix = {
	effect = {
		every_scope_state = {
			remove_modifier = colonial_institution_resettlement
			remove_modifier = colonial_institution_exploitation
		}
		if = {
			limit = {
				institution_investment_level = {
					institution = institution_colonial_affairs
					value = 1
				}
				has_law = law_type:law_colonial_resettlement
			}
			every_scope_state = {
				limit = {
					is_incorporated = no
				}
				add_modifier = {
					name = colonial_institution_resettlement
				}
			}
		}
		if = {
			limit = {
				institution_investment_level = {
					institution = institution_colonial_affairs
					value = 2
				}
				has_law = law_type:law_colonial_resettlement
			}
			every_scope_state = {
				limit = {
					is_incorporated = no
				}
				add_modifier = {
					name = colonial_institution_resettlement
					multiplier = 2
				}
			}
		}
		if = {
			limit = {
				institution_investment_level = {
					institution = institution_colonial_affairs
					value = 3
				}
				has_law = law_type:law_colonial_resettlement
			}
			every_scope_state = {
				limit = {
					is_incorporated = no
				}
				add_modifier = {
					name = colonial_institution_resettlement
					multiplier = 3
				}
			}
		}
		if = {
			limit = {
				institution_investment_level = {
					institution = institution_colonial_affairs
					value = 4
				}
				has_law = law_type:law_colonial_resettlement
			}
			every_scope_state = {
				limit = {
					is_incorporated = no
				}
				add_modifier = {
					name = colonial_institution_resettlement
					multiplier = 4
				}
			}
		}
		if = {
			limit = {
				institution_investment_level = {
					institution = institution_colonial_affairs
					value = 5
				}
				has_law = law_type:law_colonial_resettlement
			}
			every_scope_state = {
				limit = {
					is_incorporated = no
				}
				add_modifier = {
					name = colonial_institution_resettlement
					multiplier = 5
				}
			}
		}
		if = {
			limit = {
				institution_investment_level = {
					institution = institution_colonial_affairs
					value = 1
				}
				has_law = law_type:law_colonial_exploitation
			}
			every_scope_state = {
				limit = {
					is_incorporated = no
				}
				add_modifier = {
					name = colonial_institution_exploitation
				}
			}
		}
		if = {
			limit = {
				institution_investment_level = {
					institution = institution_colonial_affairs
					value = 2
				}
				has_law = law_type:law_colonial_exploitation
			}
			every_scope_state = {
				limit = {
					is_incorporated = no
				}
				add_modifier = {
					name = colonial_institution_exploitation
					multiplier = 2
				}
			}
		}
		if = {
			limit = {
				institution_investment_level = {
					institution = institution_colonial_affairs
					value = 3
				}
				has_law = law_type:law_colonial_exploitation
			}
			every_scope_state = {
				limit = {
					is_incorporated = no
				}
				add_modifier = {
					name = colonial_institution_exploitation
					multiplier = 3
				}
			}
		}
		if = {
			limit = {
				institution_investment_level = {
					institution = institution_colonial_affairs
					value = 4
				}
				has_law = law_type:law_colonial_exploitation
			}
			every_scope_state = {
				limit = {
					is_incorporated = no
				}
				add_modifier = {
					name = colonial_institution_exploitation
					multiplier = 4
				}
			}
		}
		if = {
			limit = {
				institution_investment_level = {
					institution = institution_colonial_affairs
					value = 5
				}
				has_law = law_type:law_colonial_exploitation
			}
			every_scope_state = {
				limit = {
					is_incorporated = no
				}
				add_modifier = {
					name = colonial_institution_exploitation
					multiplier = 5
				}
			}
		}
	}
}

CEN_China = {
	effect = {
		if = {
			limit = {
				NOT = { has_modifier = han_power_increase }
				exists = c:CHI
				THIS = c:CHI
				has_journal_entry = je_warlord_china
				has_global_variable = qing_accepted_han
			}
			c:CHI = {
				add_modifier = {
					name = han_power_increase
					is_decaying = no
					years = -1
				}
			}
		}
		
		if = {
			limit = {
				exists = c:CHI
				THIS = c:CHI
				has_global_variable = lost_opium_wars
				NOT = { has_modifier = chinese_opium_addiction }
				game_date <= 1896.01.01
			}
			c:CHI = { assign_opium_addiction_penalty = yes }
		}
		if = {
			limit = {
				exists = c:TPG
				THIS = c:TPG
				has_global_variable = lost_opium_wars
				NOT = { has_modifier = chinese_opium_addiction }
				game_date <= 1896.01.01
			}
			c:TPG = { assign_opium_addiction_penalty = yes }
		}
		
		if = {
			limit = {
				NOT = { has_modifier = china_ai_help }
				exists = c:CHI
				THIS = c:CHI
				is_player = no
			}
			c:CHI = {
				add_modifier = {
					name = china_ai_help
				}
			}
		}
		if = {
			limit = {
				has_modifier = china_ai_help
				exists = c:CHI
				THIS = c:CHI
				is_player = yes
			}
			c:CHI = { remove_modifier = china_ai_help }
		}
		
		if = {
			limit = {
				exists = c:CHI
				THIS = c:CHI
				has_journal_entry = je_warlord_china
				NOT = { has_global_variable = qing_accepted_han }
			}
			every_state = {
				limit = {
					OR = {
						state_region = s:STATE_OUTER_MANCHURIA
						state_region = s:STATE_SOUTHERN_MANCHURIA
						state_region = s:STATE_NORTHERN_MANCHURIA
						state_region = s:STATE_SHENGJING
					}
					NOT = { has_modifier = eight_banners }
					owner = c:CHI
				}
				add_modifier = {
					name = eight_banners
					days = -1
				}
			}
			every_state = {
				limit = {
					OR = {
						state_region = s:STATE_OUTER_MANCHURIA
						state_region = s:STATE_SOUTHERN_MANCHURIA
						state_region = s:STATE_NORTHERN_MANCHURIA
						state_region = s:STATE_SHENGJING
					}
					has_modifier = eight_banners
					NOT = { owner = c:CHI }
				}
				remove_modifier = eight_banners
			}
		}
		
		if = {
			limit = {
				exists = c:CHI
				THIS = c:CHI
			}
			every_scope_state = {
				limit = {
					is_incorporated = no
					state_region = {
						OR = {
							is_homeland = cu:han
							is_homeland = cu:manchu
						}
					}
				}
				set_state_type = incorporated
			}
		}
		
		# Ports fracture
		if = {
			limit = {
				has_journal_entry = je_warlord_china
			}
			every_state = {
				limit = {
					state_region = {
						OR = {
							is_homeland = cu:han
							is_homeland = cu:manchu
						}
					}
					ROOT ?= owner
					is_split_state = yes
					NOT = { has_modifier = chinese_treaty_port }
				}
				add_modifier = {
					name = chinese_treaty_port
				}
				owner = {
					change_global_variable = {
						name = china_warlord_explosion
						add = 4
					}
				}
			}
			every_state = {
				limit = {
					is_split_state = no
					ROOT ?= owner
					has_modifier = chinese_treaty_port
				}
				remove_modifier = chinese_treaty_port
				owner = {
					change_global_variable = {
						name = china_warlord_explosion
						add = -2
					}
				}
			}
		}
	}
}
