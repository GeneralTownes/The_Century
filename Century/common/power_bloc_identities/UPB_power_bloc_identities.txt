UPB_identity_china_tributary = {
    power_bloc_modifier = {
        power_bloc_mandate_progress_per_great_power_member_add = 10
        power_bloc_mandate_progress_per_major_power_member_add = 5
        power_bloc_mandate_progress_per_minor_power_member_add = 1
        power_bloc_mandate_progress_per_unrecognized_major_power_member_add = 3
        power_bloc_mandate_progress_per_unrecognized_regional_power_member_add = 1
        power_bloc_invite_acceptance_great_power_add = -200
        power_bloc_invite_acceptance_major_power_add = -100
        power_bloc_invite_acceptance_unrecognized_major_power_add = -10
        power_bloc_invite_acceptance_add = -30
        power_bloc_cohesion_per_member_add = -1
    }

    leader_modifier = {
        tariff_import_outside_power_bloc_mult = 0.50
        tariff_export_outside_power_bloc_mult = 0.50
    }

    non_leader_modifier = {
        tariff_import_outside_power_bloc_mult = 0.10
        tariff_export_outside_power_bloc_mult = 0.10
    }

    member_modifier = {
    }
    
    possible = {
        # Doesn't already exist
        trigger_if = {
            limit = {
                any_power_bloc = {
                    has_identity = identity:UPB_identity_china_tributary
                }
            }
            NOT = {
                any_power_bloc = {
                    has_identity = identity:UPB_identity_china_tributary
                }
            }
        }
        
        # Is monarchy
        trigger_if = {
            limit = { # RRK compat
                RRK_is_active_trigger = yes
            }
            coa_monarchy_trigger = yes
        }
        trigger_else = {
            has_law = law_type:law_monarchy
        }
        
        # Is certifiably The Legitimate China:tm:
        UPB_st_controls_china = yes
    }

    can_leave = {
        OR = {
            is_power_bloc_leader = yes
            power_bloc = {
                leverage_advantage = {
                    target = root
                    value <= 30
                }
            }
        }
    }

    icon = "gfx/interface/icons/invention_icons/power_of_the_purse.dds"
    background = "gfx/interface/power_blocs/backgrounds/pb_background_generic.dds"

    visible = {
        UPB_st_is_china = yes
    }

    mandate_progress = power_bloc_mandate_progress_by_rank
    
    on_created = {}
    
    cohesion = {
        add = {
            add = 0.3
            multiply = define:NPowerBlocs|COHESION_TARGET_MAX
            desc = POWER_BLOC_COHESION_BASE
        }
        
        add = {
            scope:power_bloc = {
                every_power_bloc_member = {
                    limit = {
                        is_power_bloc_leader = no
                        any_primary_culture  = {
                            OR = {
                                has_discrimination_trait = east_asian_heritage
                                has_discrimination_trait = central_asian_heritage
                                has_discrimination_trait = south_asian_heritage
                                has_discrimination_trait = southeast_asian_heritage
                                has_discrimination_trait = north_asian_heritage
                            }
                        }
                    }
                    
                    # Base amount (from country rank)
                    if = {
                        limit = {
                            country_rank <= rank_value:insignificant_power
                        }
                        add = 0.5
                    }
                    else_if = {
                        limit = {
                            country_rank <= rank_value:minor_power
                        }
                        add = 1
                    }
                    else_if = {
                        limit = {
                            country_rank <= rank_value:major_power
                        }
                        add = 3
                    }
                    else = {
                        add = 5
                    }
                    
                    # Multiplier (from cultural proximity)
                    if = {
                        limit = {
                            any_primary_culture = {
                                OR = {
                                    has_discrimination_trait = east_asian_heritage
                                    has_discrimination_trait = sinosphere # Vietnam
                                }
                            }
                        }
                        multiply = 1.25
                    }
                }
            }
            desc = UPB_tt_asian_bloc_members
        }
        
        add = {
            if = {
                limit = { exists = scope:with_country }
                add = "power_bloc_share_prestige_with(scope:with_country)"
            }
            else_if = {
                limit = { exists = scope:without_country }
                add = "power_bloc_share_prestige_without(scope:without_country)"
            }
            else = {
                add = power_bloc_share_prestige
            }
            multiply = define:NPowerBlocs|COHESION_TARGET_MAX
            multiply = 0.5
            desc = POWER_BLOC_COHESION_SHARE_PRESTIGE
        }
        
        add = {
            if = {
                limit = { exists = scope:with_country }
                add = "scope:power_bloc.power_bloc_worst_leader_relations_with(scope:with_country)"
            }
            else_if = {
                limit = { exists = scope:without_country }
                add = "scope:power_bloc.power_bloc_worst_leader_relations_without(scope:without_country)"
            }
            else = {
                add = scope:power_bloc.power_bloc_worst_leader_relations
            }
            divide = define:NDiplomacy|MIN_RELATIONS
            multiply = define:NPowerBlocs|COHESION_TARGET_MAX
            multiply = -0.5
            max = 0
            desc = POWER_BLOC_COHESION_WORST_LEADER_RELATIONS
        }
        
        add = {
            if = {
                limit = { exists = scope:with_country }
                add = "scope:power_bloc.power_bloc_worst_economic_dependence_with(scope:with_country)"
            }
            else_if = {
                limit = { exists = scope:without_country }
                add = "scope:power_bloc.power_bloc_worst_economic_dependence_without(scope:without_country)"
            }
            else = {
                add = scope:power_bloc.power_bloc_worst_economic_dependence
            }
            add = -3.5
            divide = define:NDiplomacy|ECONOMIC_DEPENDENCE_MAX
            multiply = define:NPowerBlocs|COHESION_TARGET_MAX
            multiply = 0.25
            desc = POWER_BLOC_COHESION_WORST_ECONOMIC_DEPENDENCE
        }
    }
    
    ai_weight = {
        value = 100000000
    }
}
